generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("PINK_PRISMA_URL") 
  directUrl = env("PINK_URL_NON_POOLING")
}

model User {
id       String   @id @default(cuid())
user_id  String   @unique
username String?
first_name String?
earned_coins Int @default(0)
createdAt DateTime @default(now())
updatedAt DateTime @updatedAt
}

model GameSession {
  id            String   @id @default(cuid())
  user          User     @relation(fields: [user_id], references: [id])
  user_id       String
  claimStreak   Int      @default(0) // Keeps track of the current streak (e.g., 1 for Day 1, 2 for Day 2, etc.)
  lastClaimedAt DateTime? // When the user last claimed the reward
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
}

model GameHistory {
  id          String   @id @default(cuid())
  user        User     @relation(fields: [user_id], references: [id])
  user_id     String
  action      String   // Example: "mine_started", "task_completed", "friend_referred"
  timestamp   DateTime @default(now())
}

model Referral {
  id          String   @id @default(cuid())
  user        User     @relation(fields: [user_id], references: [id])
  user_id     String
  referred_id String   // The user_id of the friend who was referred
  createdAt   DateTime @default(now())
}
